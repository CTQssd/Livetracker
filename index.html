<!DOCTYPE html>
<html lang="vi" data-theme="dark"> <!-- B·∫Øt ƒë·∫ßu v·ªõi Dark Theme -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[üê∂] Unbox A Knife - Live Stats</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* === DARK THEME (DEFAULT) === */
            --primary: #FF4655;
            --primary-dark: #DC2936;
            --secondary: #00D4FF;
            --success: #44D362;
            --danger: #FF4655;
            
            --bg-main: #0A0E1A;
            --bg-card: #0F1923;
            --bg-card-hover: #141F2B;
            --bg-input: #1A2332;
            
            --text-primary: #FFFFFF;
            --text-secondary: #94A3B8;
            --text-muted: #64748B;
            
            --border-color: #1E293B;
            --border-hover: #334155;
            
            --glow-primary: 0 0 20px rgba(255, 70, 85, 0.5);
            --glow-secondary: 0 0 20px rgba(0, 212, 255, 0.5);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            
            --grid-color: rgba(255, 70, 85, 0.1);
            --orb-opacity: 0.5;
        }

        [data-theme="light"] {
            /* === LIGHT THEME === */
            --primary: #FF4655;
            --primary-dark: #DC2936;
            --secondary: #007BFF;
            --success: #28a745;
            --danger: #dc3545;

            --bg-main: #F0F2F5;
            --bg-card: #FFFFFF;
            --bg-card-hover: #F8FAFC;
            --bg-input: #E2E8F0;

            --text-primary: #1E293B;
            --text-secondary: #475569;
            --text-muted: #64748B;
            
            --border-color: #E2E8F0;
            --border-hover: #CBD5E1;

            --glow-primary: 0 0 20px rgba(255, 70, 85, 0.3);
            --glow-secondary: 0 0 20px rgba(0, 123, 255, 0.3);
            --shadow-xl: 0 20px 25px -5px rgba(30, 41, 59, 0.1), 0 10px 10px -5px rgba(30, 41, 59, 0.04);

            --grid-color: rgba(30, 41, 59, 0.05);
            --orb-opacity: 0.2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Styles for header, cards, etc. remain the same */
        .bg-grid{position:fixed;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(var(--grid-color) 1px,transparent 1px),linear-gradient(90deg,var(--grid-color) 1px,transparent 1px);background-size:50px 50px;animation:grid-move 10s linear infinite;z-index:0}@keyframes grid-move{0%{transform:translate(0,0)}100%{transform:translate(50px,50px)}}.glow-orb{position:fixed;border-radius:50%;filter:blur(40px);opacity:var(--orb-opacity);animation:float-orb 20s infinite ease-in-out;z-index:0;transition:opacity .3s ease}.glow-orb-1{width:400px;height:400px;background:var(--primary);top:-200px;right:-200px}.glow-orb-2{width:300px;height:300px;background:var(--secondary);bottom:-150px;left:-150px;animation-delay:-10s}@keyframes float-orb{0%,100%{transform:translate(0,0) scale(1)}33%{transform:translate(30px,-30px) scale(1.1)}66%{transform:translate(-30px,30px) scale(.9)}}.container{max-width:1400px;margin:0 auto;padding:20px;position:relative;z-index:1}.header-bar{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px 0}.logo{display:flex;align-items:center;gap:15px}.logo-icon{width:50px;height:50px;background:linear-gradient(135deg,var(--primary),var(--primary-dark));border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;color:#fff;box-shadow:var(--glow-primary);animation:pulse-logo 2s infinite}@keyframes pulse-logo{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}.logo-text{font-size:24px;font-weight:800;color:var(--text-primary)}.controls{display:flex;gap:15px}.control-btn{width:45px;height:45px;background:var(--bg-card);border:2px solid var(--border-color);border-radius:12px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;color:var(--text-secondary)}.control-btn:hover{background:var(--bg-card-hover);border-color:var(--primary);color:var(--primary);transform:translateY(-2px);box-shadow:var(--glow-primary)}.control-btn.active{background:var(--primary);border-color:var(--primary);color:var(--text-primary)}[data-theme=light] .control-btn.active{background:var(--bg-main);border-color:var(--primary);color:var(--primary)}.live-badge{display:inline-flex;align-items:center;gap:8px;background:var(--danger);color:#fff;padding:8px 16px;border-radius:100px;font-weight:600;font-size:14px;animation:live-pulse 2s infinite}@keyframes live-pulse{0%,100%{opacity:1}50%{opacity:.8}}.live-dot{width:8px;height:8px;background:#fff;border-radius:50%;animation:blink 1.5s infinite}@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}.game-showcase{background:var(--bg-card);border:1px solid var(--border-color);border-radius:24px;overflow:hidden;margin-bottom:30px;position:relative}.game-info{padding:30px}.game-title{font-size:36px;font-weight:800;margin-bottom:10px;display:flex;align-items:center;gap:15px}.game-emoji{font-size:42px;animation:bounce-emoji 3s infinite}@keyframes bounce-emoji{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}.game-meta{display:flex;align-items:center;gap:20px;color:var(--text-secondary)}.meta-item{display:flex;align-items:center;gap:8px}.meta-item i{color:var(--primary)}.stats-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}.stat-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:24px;position:relative;overflow:hidden;transition:all .3s ease;cursor:pointer}.stat-card:before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--primary),var(--secondary));transform:scaleX(0);transition:transform .3s ease}.stat-card:hover{background:var(--bg-card-hover);border-color:var(--border-hover);transform:translateY(-4px);box-shadow:var(--shadow-xl)}.stat-card:hover:before{transform:scaleX(1)}.stat-card.primary{background:linear-gradient(135deg,var(--primary),var(--primary-dark));border:none}.stat-card.primary .stat-label,.stat-card.primary .stat-value{color:#fff}.stat-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}.stat-icon{width:48px;height:48px;background:var(--bg-input);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:20px;color:var(--primary)}.stat-card.primary .stat-icon{background:rgba(255,255,255,.2);color:#fff}[data-theme=light] .stat-card.primary .stat-icon{background:rgba(255,255,255,.5);color:#fff}.stat-change{display:flex;align-items:center;gap:4px;padding:4px 8px;background:rgba(68,211,98,.1);color:var(--success);border-radius:6px;font-size:12px;font-weight:600}.stat-change.down{background:rgba(255,70,85,.1);color:var(--danger)}.stat-label{color:var(--text-muted);font-size:14px;font-weight:500;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px}.stat-value{font-size:32px;font-weight:800;font-family:'JetBrains Mono',monospace;color:var(--text-primary)}.stat-card.updating .stat-value{animation:value-update .5s ease}@keyframes value-update{0%{transform:scale(1)}50%{transform:scale(1.1);color:var(--primary)}100%{transform:scale(1)}}.description-card{background:var(--bg-card);border:1px solid var(--border-color);border-radius:16px;padding:24px;margin-bottom:30px}.description-title{font-size:18px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:10px;color:var(--text-primary)}.description-text{color:var(--text-secondary);line-height:1.6;white-space:pre-line}.footer{text-align:center;padding:30px 0;border-top:1px solid var(--border-color);margin-top:50px}.footer-text{color:var(--text-muted);font-size:14px}.footer-link{color:var(--primary);text-decoration:none;font-weight:600;transition:opacity .3s ease}.footer-link:hover{opacity:.8}.update-timer{position:fixed;bottom:30px;right:30px;background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;padding:12px 20px;display:flex;align-items:center;gap:10px;box-shadow:var(--shadow-xl);z-index:100}.update-timer i{color:var(--success);animation:spin 2s linear infinite}@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}.update-text{font-size:14px;color:var(--text-secondary)}.update-time{color:var(--text-primary);font-weight:600;font-family:'JetBrains Mono',monospace}.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--bg-card);border:1px solid var(--border-color);padding:16px 24px;border-radius:12px;box-shadow:var(--shadow-xl);opacity:0;transition:all .3s ease;z-index:1000;display:flex;align-items:center;gap:12px;color:var(--text-primary)}.toast.show{transform:translateX(-50%) translateY(0);opacity:1}.toast.success{border-left:4px solid var(--success)}.toast.error{border-left:4px solid var(--danger)}@media (max-width:768px){.container{padding:15px}.header-bar{flex-direction:column;gap:20px}.game-title{font-size:28px}.stats-container{grid-template-columns:1fr}.stat-value{font-size:28px}.update-timer{bottom:80px;right:20px;left:20px}}
    </style>
</head>
<body>
    <!-- Background Effects -->
    <div class="bg-grid"></div>
    <div class="glow-orb glow-orb-1"></div>
    <div class="glow-orb glow-orb-2"></div>

    <!-- Main Container -->
    <div class="container">
        <!-- Header Bar -->
        <div class="header-bar">
            <div class="logo">
                <div class="logo-icon">üéÆ</div>
                <div class="logo-text">ROBLOX TRACKER</div>
            </div>
            
            <div class="controls">
                <div class="live-badge">
                    <div class="live-dot"></div>
                    LIVE
                </div>
                <div class="control-btn" id="themeToggle" title="Toggle Theme">
                    <i class="fas fa-moon"></i>
                </div>
                <div class="control-btn" id="soundToggle" title="Toggle Sound">
                    <i class="fas fa-volume-up"></i>
                </div>
            </div>
        </div>

        <!-- Game Showcase -->
        <div class="game-showcase">
            <div class="game-info">
                <div class="game-title">
                    <span class="game-emoji">üê∂</span>
                    <span id="gameTitle">Loading...</span>
                </div>
                <div class="game-meta">
                    <div class="meta-item">
                        <i class="fas fa-users"></i>
                        <span id="creatorName">Loading...</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-gamepad"></i>
                        <span id="gameGenre">Loading...</span>
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-server"></i>
                        <span>Max <span id="maxPlayers">-</span> Players</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-container">
            <!-- Total Visits -->
            <div class="stat-card primary" id="visitsCard">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="stat-change" id="visitsChange" style="display: none;">
                        <i class="fas fa-arrow-up"></i>
                        <span>+0</span>
                    </div>
                </div>
                <div class="stat-label">Total Visits</div>
                <div class="stat-value" id="totalVisits">-</div>
            </div>

            <!-- Playing Now -->
            <div class="stat-card" id="playingCard">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-play-circle"></i>
                    </div>
                    <div class="stat-change" id="playingChange" style="display: none;">
                        <i class="fas fa-arrow-up"></i>
                        <span>+0</span>
                    </div>
                </div>
                <div class="stat-label">Playing Now</div>
                <div class="stat-value" id="playingNow">-</div>
            </div>

            <!-- Favorites -->
            <div class="stat-card" id="favoritesCard">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="stat-change" id="favoritesChange" style="display: none;">
                        <i class="fas fa-arrow-up"></i>
                        <span>+0</span>
                    </div>
                </div>
                <div class="stat-label">Favorites</div>
                <div class="stat-value" id="totalFavorites">-</div>
            </div>

            <!-- Created Date -->
            <div class="stat-card">
                <div class="stat-header">
                    <div class="stat-icon">
                        <i class="fas fa-calendar"></i>
                    </div>
                </div>
                <div class="stat-label">Created</div>
                <div class="stat-value" id="createdDate" style="font-size: 18px;">-</div>
            </div>
        </div>

        <!-- Description -->
        <div class="description-card">
            <div class="description-title">
                <i class="fas fa-info-circle" style="color: var(--primary);"></i>
                About This Game
            </div>
            <div class="description-text" id="gameDescription">Loading game description...</div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-text">
                Made with ‚ù§Ô∏è for Roblox Community | 
                <a href="https://www.roblox.com/games/75732384003161/Unbox-A-Knife" target="_blank" class="footer-link">
                    Play Unbox A Knife
                </a>
            </div>
        </div>
    </div>

    <!-- Update Timer -->
    <div class="update-timer">
        <i class="fas fa-sync-alt"></i>
        <span class="update-text">Last updated:</span>
        <span class="update-time" id="lastUpdate">00:00:00</span>
    </div>

    <!-- Toast Container -->
    <div class="toast" id="toast"></div>

    <script>
        // Configuration
        const UNIVERSE_ID = '8743656513';
        const API_URL = `https://games.roblox.com/v1/games?universeIds=${UNIVERSE_ID}`;
        const UPDATE_INTERVAL = 1000; // 1 second

        // State
        let previousData = {};
        let soundEnabled = true;
        let updateCount = 0;
        let currentTheme = 'dark';

        // Sound System
        class SoundManager {
            constructor() {
                this.context = null;
                this.initAudioContext();
            }
            initAudioContext() {
                try {
                    window.AudioContext = window.AudioContext || window.webkitAudioContext;
                    this.context = new AudioContext();
                } catch (e) { console.log('Web Audio API not supported'); }
            }
            playTone(frequency, duration = 100) {
                if (!soundEnabled || !this.context) return;
                const oscillator = this.context.createOscillator();
                const gainNode = this.context.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(this.context.destination);
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.3, this.context.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.context.currentTime + duration / 1000);
                oscillator.start(this.context.currentTime);
                oscillator.stop(this.context.currentTime + duration / 1000);
            }
            playSuccess() { this.playTone(523.25, 150); setTimeout(() => this.playTone(659.25, 150), 100); setTimeout(() => this.playTone(783.99, 200), 200); }
            playUpdate() { this.playTone(880, 100); }
            playClick() { this.playTone(600, 50); }
        }
        const soundManager = new SoundManager();

        // Toast Notifications
        function showToast(message, type = 'default') {
            const toast = document.getElementById('toast');
            toast.className = `toast show ${type}`;
            toast.innerHTML = `
                ${type === 'success' ? '<i class="fas fa-check-circle" style="color: var(--success);"></i>' : ''}
                ${type === 'error' ? '<i class="fas fa-exclamation-circle" style="color: var(--danger);"></i>' : ''}
                <span>${message}</span>`;
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        // Format Numbers
        function formatNumber(num) {
            if (num === undefined || num === null) return '-';
            if (num >= 1000000000) return (num / 1000000000).toFixed(1) + 'B';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 10000) return (num / 1000).toFixed(1) + 'K';
            return num.toLocaleString();
        }

        // Format Date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('vi-VN', { year: 'numeric', month: 'short', day: 'numeric' });
        }

        // Update Stats with Animation
        function updateStat(elementId, newValue, cardId, changeId, previousValue) {
            const element = document.getElementById(elementId);
            const card = document.getElementById(cardId);
            const changeElement = document.getElementById(changeId);
            if (element.textContent !== newValue) {
                element.textContent = newValue;
                card.classList.add('updating');
                setTimeout(() => card.classList.remove('updating'), 500);
                if (changeId && previousValue !== undefined) {
                    const numericNew = parseInt(String(newValue).replace(/[^0-9]/g, '')) * (String(newValue).endsWith('M') ? 100000 : String(newValue).endsWith('B') ? 100000000 : 1);
                    const numericPrev = previousValue;
                    const diff = numericNew - numericPrev;
                    if (diff !== 0) {
                        changeElement.style.display = 'flex';
                        changeElement.className = `stat-change ${diff > 0 ? '' : 'down'}`;
                        changeElement.querySelector('i').className = `fas fa-arrow-${diff > 0 ? 'up' : 'down'}`;
                        changeElement.querySelector('span').textContent = `${diff > 0 ? '+' : ''}${formatNumber(diff)}`;
                        setTimeout(() => { changeElement.style.display = 'none'; }, 3000);
                    }
                }
                return true;
            }
            return false;
        }

        // Fetch Game Data
        async function fetchGameData() {
            // =========================================================
            //  THE IMPORTANT FIX IS HERE: The "cache buster"
            // =========================================================
            const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(API_URL)}&_=${new Date().getTime()}`;
            
            try {
                const response = await fetch(proxyUrl);
                if (!response.ok) throw new Error('Network error');
                const data = await response.json();
                const robloxData = JSON.parse(data.contents);
                if (robloxData.data && robloxData.data.length > 0) {
                    const game = robloxData.data[0];
                    if (updateCount === 0) {
                        document.getElementById('gameTitle').textContent = game.name.replace('[üê∂]', '').trim();
                        document.getElementById('creatorName').textContent = game.creator.name;
                        document.getElementById('gameGenre').textContent = game.genre_l1 || game.genre || 'All';
                        document.getElementById('maxPlayers').textContent = game.maxPlayers;
                        document.getElementById('createdDate').textContent = formatDate(game.created);
                        document.getElementById('gameDescription').textContent = game.description;
                        soundManager.playSuccess();
                        showToast('Connected to Roblox API!', 'success');
                    }
                    const visitsUpdated = updateStat('totalVisits', formatNumber(game.visits), 'visitsCard', 'visitsChange', previousData.visits);
                    const playingUpdated = updateStat('playingNow', formatNumber(game.playing), 'playingCard', 'playingChange', previousData.playing);
                    const favoritesUpdated = updateStat('totalFavorites', formatNumber(game.favoritedCount), 'favoritesCard', 'favoritesChange', previousData.favoritedCount);
                    if (updateCount > 0 && (visitsUpdated || playingUpdated || favoritesUpdated)) {
                        soundManager.playUpdate();
                    }
                    if (previousData.visits && game.visits > previousData.visits) {
                        const diff = game.visits - previousData.visits;
                        showToast(`üéâ +${diff} new visits!`, 'success');
                    }
                    document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
                    previousData = { visits: game.visits, playing: game.playing, favoritedCount: game.favoritedCount };
                    updateCount++;
                }
            } catch (error) {
                console.error('Error fetching data:', error);
                if (updateCount === 0) showToast('Failed to connect to Roblox API', 'error');
            }
        }

        // Theme Toggle Logic
        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            const icon = document.getElementById('themeToggle').querySelector('i');
            icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            localStorage.setItem('theme', theme);
            currentTheme = theme;
        }
        function toggleTheme() {
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            applyTheme(newTheme);
            soundManager.playClick();
        }

        // Sound Toggle Logic
        document.getElementById('soundToggle').addEventListener('click', function() {
            soundEnabled = !soundEnabled;
            this.classList.toggle('active');
            this.querySelector('i').className = soundEnabled ? 'fas fa-volume-up' : 'fas fa-volume-mute';
            soundManager.playClick();
            showToast(soundEnabled ? 'üîä Sound enabled' : 'üîá Sound muted');
        });
        
        // Theme Toggle Event Listener
        document.getElementById('themeToggle').addEventListener('click', toggleTheme);

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            applyTheme(savedTheme);
            fetchGameData();
            setInterval(fetchGameData, UPDATE_INTERVAL);
            document.querySelectorAll('.stat-card').forEach(card => card.addEventListener('click', () => soundManager.playClick()));
        });

        // Resume audio context on user interaction
        document.addEventListener('click', () => {
            if (soundManager.context && soundManager.context.state === 'suspended') {
                soundManager.context.resume();
            }
        }, { once: true });
    </script>
</body>
</html>
